(()=>{var S=(()=>{let a=null,o=null,g=0,r=0,i=!0,m=()=>{g+=1},d=()=>`(${r}/${g}) [${parseInt(r/g*100).toFixed(0)}%]`;return{init:()=>{a=document.getElementById("progress-info"),o=document.getElementById("progress-bar"),a.style.display="block"},add:m,invalid:l=>{i=!1,o.style.backgroundColor="red",a.innerText=`Error loading ${l} ${d()}`},complete:l=>{i&&(r+=1,a.innerText=`Loading ${l} complete ${d()}`,o.style.width=Math.min(r/g*100,100).toString()+"%",r===g&&document.dispatchEvent(new Event("progressDone")))}}})();var G=(()=>{let a=null,o=null,g=!0,r=1e3*60*60*6,i="images",m=async f=>{let s=f.getAttribute("data-src"),b="x-expiration-time";if(a.has(s)){f.src=a.get(s),S.complete("image");return}let k=v=>fetch(s).then($=>$.blob().then(A=>{let O=new Headers($.headers);return O.append(b,String(Date.now()+r)),v.put(s,new Response(A,{headers:O})).then(()=>A)}));await caches.open(i).then(v=>v.match(s).then($=>$?Date.now()<=parseInt($.headers.get(b))?$.blob():v.delete(s).then(A=>A?k(v):$.blob()):k(v)).then($=>{f.src=URL.createObjectURL($),a.set(s,f.src),S.complete("image")})).catch(()=>S.invalid("image"))},d=f=>{f.onerror=()=>S.invalid("image"),f.onload=()=>S.complete("image"),f.complete&&f.naturalWidth!==0&&f.naturalHeight!==0?S.complete("image"):f.complete&&S.invalid("image")},w=()=>g,c=f=>{r=Number(f)},y=()=>{(async()=>{for(let f of o)f.hasAttribute("data-src")?await m(f):d(f)})()};return{init:()=>(a=new Map,o=document.querySelectorAll("img"),o.forEach(S.add),g=Array.from(o).some(f=>f.hasAttribute("data-src")),{load:y,setTtl:c,hasDataSrc:w})}})();var J=(()=>{let a=null,o=null,g=!1,r='<i class="fa-solid fa-circle-pause spin-button"></i>',i='<i class="fa-solid fa-circle-play"></i>',m=async()=>{if(navigator.onLine){a.disabled=!0;try{await o.play(),g=!0,a.disabled=!1,a.innerHTML=r}catch(c){g=!1,alert(c)}}},d=()=>{g=!1,o.pause(),a.innerHTML=i};return{init:()=>{a=document.getElementById("button-music"),o=new Audio(a.getAttribute("data-url")),o.volume=1,o.loop=!0,o.muted=!1,o.currentTime=0,o.autoplay=!1,o.controls=!1,o.addEventListener("canplay",m),a.addEventListener("offline",d),a.addEventListener("click",()=>g?d():m())}}})();var E=(()=>{let a=c=>String(c).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),o=(c,y)=>{let l=null;l=setTimeout(()=>{c(),clearTimeout(l),l=null},y)};return{copy:async(c,y=null,l=1500)=>{let f=c.getAttribute("data-copy");if(!f||f.length==0){alert("Nothing to copy");return}c.disabled=!0;try{await navigator.clipboard.writeText(f)}catch{c.disabled=!1,alert("Failed to copy");return}let s=c.innerHTML;c.innerHTML=y||'<i class="fa-solid fa-check"></i>',o(()=>{c.disabled=!1,c.innerHTML=s},l)},timeOut:o,escapeHtml:a,base64Encode:c=>{let l=new TextEncoder().encode(c);return window.btoa(String.fromCharCode(...l))},base64Decode:c=>{let y=new TextDecoder,l=Uint8Array.from(window.atob(c),f=>f.charCodeAt(0));return y.decode(l)},disableButton:(c,y="Loading")=>{c.disabled=!0;let l=c.innerHTML;return c.innerHTML=`<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem"></span>${y}`,{restore:()=>{c.innerHTML=l,c.disabled=!1}}},disableCheckbox:c=>{c.disabled=!0;let y=document.querySelector(`label[for="${c.id}"]`),l=y.innerHTML;return y.innerHTML=`<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem"></span>${l}`,{restore:()=>{y.innerHTML=l,c.disabled=!1}}},parseUserAgent:c=>{let y=[{type:"Mobile",regex:/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i},{type:"Tablet",regex:/iPad|Android(?!.*Mobile)/i},{type:"Desktop",regex:/Windows NT|Macintosh|Linux/i}],l=[{name:"Chrome",regex:/Chrome|CriOS/i},{name:"Safari",regex:/Safari/i},{name:"Edge",regex:/Edg|Edge/i},{name:"Firefox",regex:/Firefox|FxiOS/i},{name:"Opera",regex:/Opera|OPR/i},{name:"Internet Explorer",regex:/MSIE|Trident/i}],f=[{name:"Windows",regex:/Windows NT ([\d.]+)/i},{name:"MacOS",regex:/Mac OS X ([\d_]+)/i},{name:"Android",regex:/Android ([\d.]+)/i},{name:"iOS",regex:/OS ([\d_]+) like Mac OS X/i},{name:"Linux",regex:/Linux/i}],s=y.find(A=>A.regex.test(c))?.type||"Unknown",b=l.find(A=>A.regex.test(c))?.name||"Unknown",k=f.find(A=>A.regex.test(c)),v=k&&c.match(k.regex)?.[1]?.replace(/_/g,".")||"",$=k?k.name:"Unknown";return v=v?`${$} ${v}`:$,`${b} ${s} ${v}`}}})();var T=a=>{let o=(d=null)=>{let w=JSON.parse(localStorage.getItem(a));return d?w[String(d)]:w},g=(d,w)=>{let c=o();c[String(d)]=w,localStorage.setItem(a,JSON.stringify(c))},r=d=>Object.keys(o()).includes(String(d)),i=d=>{if(!r(d))return;let w=o();delete w[String(d)],localStorage.setItem(a,JSON.stringify(w))},m=()=>localStorage.setItem(a,"{}");return localStorage.getItem(a)||m(),{set:g,get:o,has:r,clear:m,unset:i}};var I=(()=>{let a={"#000000":"#ffffff","#ffffff":"#000000","#212529":"#f8f9fa","#f8f9fa":"#212529"},o=["#ffffff","#f8f9fa"],g=["#000000","#212529"],r=!1,i=null,m=null,d=null,w=null,c=t=>{Object.entries({"text-light":"text-dark","btn-theme-light":"btn-theme-dark","bg-dark":"bg-light","bg-black":"bg-white","bg-theme-dark":"bg-theme-light","color-theme-black":"color-theme-white","btn-outline-light":"btn-outline-dark","bg-cover-black":"bg-cover-white"}).forEach(([e,n])=>{t.classList.contains(e)&&t.classList.replace(e,n)})},y=t=>{Object.entries({"text-dark":"text-light","btn-theme-dark":"btn-theme-light","bg-light":"bg-dark","bg-white":"bg-black","bg-theme-light":"bg-theme-dark","color-theme-white":"color-theme-black","btn-outline-dark":"btn-outline-light","bg-cover-white":"bg-cover-black"}).forEach(([e,n])=>{t.classList.contains(e)&&t.classList.replace(e,n)})},l=()=>i.set("active","light"),f=()=>i.set("active","dark"),s=()=>{l(),document.documentElement.setAttribute("data-bs-theme","light");let t=[".text-light",".btn-theme-light",".bg-dark",".bg-black",".bg-theme-dark",".color-theme-black",".btn-outline-light",".bg-cover-black"].join(", ");document.querySelectorAll(t).forEach(h=>d.observe(h))},b=()=>{f(),document.documentElement.setAttribute("data-bs-theme","dark");let t=[".text-dark",".btn-theme-dark",".bg-light",".bg-white",".bg-theme-light",".color-theme-white",".btn-outline-dark",".bg-cover-white"].join(", ");document.querySelectorAll(t).forEach(h=>w.observe(h))},k=(t=null,h=null)=>{let e=i.get("active")==="dark";return t&&h?e?t:h:e},v=()=>k()?s():b(),$=()=>r,A=()=>{let t=(h,e)=>new IntersectionObserver((n,p)=>{n.filter(L=>L.isIntersecting).forEach(L=>h(L.target)),n.filter(L=>!L.isIntersecting).forEach(L=>h(L.target)),p.disconnect();let x=m.getAttribute("content");m.setAttribute("content",e.some(L=>L===x)?a[x]:x)});d=t(c,g),w=t(y,o)};return{init:()=>{switch(i=T("theme"),m=document.querySelector('meta[name="theme-color"]'),A(),i.has("active")||(window.matchMedia("(prefers-color-scheme: dark)").matches?f():l()),document.body.getAttribute("data-theme")){case"dark":f();break;case"light":l();break;default:r=!0}k()?b():s()},spyTop:()=>{let t=e=>{e.filter(n=>n.isIntersecting).forEach(n=>{let p=["bg-black","bg-white"].some(x=>n.target.classList.contains(x))?k(g[0],o[0]):k(g[1],o[1]);m.setAttribute("content",p)})},h=new IntersectionObserver(t,{rootMargin:"0% 0% -95% 0%"});document.querySelectorAll("section").forEach(e=>h.observe(e))},change:v,isDarkMode:k,isAutoMode:$}})();var B=(()=>{let a=(s,b,k)=>({code:s,data:b,error:k}),o=(s=0)=>({love:s}),g=({uuid:s,own:b,name:k,presence:v,comment:$,created_at:A,is_admin:O,ip:u,user_agent:t,comments:h,like:e})=>({uuid:s,own:b,name:k,presence:v,comment:$,created_at:A,is_admin:O??!1,ip:u,user_agent:t,comments:h?.map(g)??[],like:o(e?.love??0)});return{uuidResponse:({uuid:s})=>({uuid:s}),baseResponse:a,tokenResponse:({token:s})=>({token:s}),statusResponse:({status:s})=>({status:s}),commentResponse:({name:s,presence:b,comment:k,is_admin:v,created_at:$})=>({name:s,presence:b,comment:k,is_admin:v,created_at:$}),likeCommentResponse:o,getCommentResponse:g,getCommentsResponse:s=>s.map(g),commentShowMore:(s,b=!1)=>({uuid:s,show:b}),postCommentRequest:(s,b,k,v)=>({id:s,name:b,presence:k,comment:v}),postSessionRequest:(s,b)=>({email:s,password:b}),updateCommentRequest:(s,b)=>({presence:s,comment:b})}})();var U="GET",W="PUT",j="POST",K="PATCH",X="DELETE",P=(a,o)=>{let g=document.body.getAttribute("data-url"),r={method:String(a).toUpperCase(),headers:new Headers({Accept:"application/json","Content-Type":"application/json"})};return g.slice(-1)==="/"&&(g=g.slice(0,-1)),{send(i=null){return fetch(g+o,r).then(m=>m.json().then(d=>{if(m.status>=500&&(d.message??d[0]))throw new Error(d.message??d[0]);if(d.error)throw new Error(d.error[0]);return i&&(d.data=i(d.data)),B.baseResponse(d.code,d.data,d.error)})).catch(m=>{throw alert(m),new Error(m)})},download(){return fetch(g+o,r).then(i=>{if(i.status!==200)return!1;let m=document.querySelector("a[download]");m&&document.body.removeChild(m);let d=i.headers.get("content-disposition")?.match(/filename="(.+)"/)?.[1]??"download.csv";return i.blob().then(w=>{let c=document.createElement("a"),y=window.URL.createObjectURL(w);return c.href=y,c.download=d,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(y),!0})}).catch(i=>{throw alert(i),new Error(i)})},token(i){return i.split(".").length===3?(r.headers.append("Authorization","Bearer "+i),this):(r.headers.append("x-access-key",i),this)},body(i){return r.body=JSON.stringify(i),this}}};var M=(()=>{let a=null,o=()=>a.get("token"),g=y=>P(j,"/api/session").body(y).send(B.tokenResponse).then(l=>(l.code===200&&i(l.data.token),l.code===200),()=>!1),r=()=>a.unset("token"),i=y=>a.set("token",y),m=()=>String(o()??".").split(".").length===3;return{init:()=>{a=T("session")},guest:()=>P(U,"/api/config").token(o()).send().then(y=>{if(y.code!==200)return y;let l=T("config");for(let[f,s]of Object.entries(y.data))l.set(f,s);return y}),login:g,logout:r,decode:()=>{if(!m())return null;try{return JSON.parse(window.atob(o().split(".")[1]))}catch{return null}},isAdmin:m,setToken:i,getToken:o}})();var Y=(()=>{let a=null,o=!0,g=s=>new Promise(b=>{let k=parseFloat(a.style.opacity),v=null,$=s?.05:-.05,A=s?1:0;v=setInterval(()=>{k=Math.max(0,Math.min(1,k+$)),a.style.opacity=k.toFixed(2),k===A&&(b(),clearInterval(v),v=null)},10)}),r=()=>{let s=null;s=setTimeout(()=>{clearTimeout(s),s=null,o&&d()},3e3)},i=()=>{let s=a.firstElementChild.firstElementChild;s.classList.remove("bg-success"),s.classList.add("bg-danger"),s.firstElementChild.innerHTML='<i class="fa-solid fa-ban me-2"></i>Koneksi tidak tersedia'},m=()=>{let s=a.firstElementChild.firstElementChild;s.classList.remove("bg-danger"),s.classList.add("bg-success"),s.firstElementChild.innerHTML='<i class="fa-solid fa-cloud me-2"></i>Koneksi tersedia kembali'},d=async()=>{await g(!1),i()},w=()=>{let s=["input[data-offline-disabled]","button[data-offline-disabled]","select[data-offline-disabled]","textarea[data-offline-disabled]"].join(", ");document.querySelectorAll(s).forEach(b=>{b.dispatchEvent(new Event(l()?"online":"offline")),b.setAttribute("data-offline-disabled",l()?"false":"true"),b.tagName==="BUTTON"?l()?b.classList.remove("disabled"):b.classList.add("disabled"):l()?b.removeAttribute("disabled"):b.setAttribute("disabled","true")})},c=()=>{o=!1,i(),g(!0),w()},y=()=>{o=!0,m(),r(),w()},l=()=>o;return{init:()=>{window.addEventListener("online",y),window.addEventListener("offline",c),a=document.getElementById("offline-mode"),a.innerHTML=`
        <div class="d-flex justify-content-center mx-auto">
            <div class="d-flex justify-content-center align-items-center rounded-pill my-2 bg-danger shadow">
                <small class="text-center py-1 px-2 mx-1 mt-1 mb-0 text-white" style="font-size: 0.8rem;"></small>
            </div>
        </div>`},isOnline:l}})();var R=(()=>{let a=null,o=null,g=null,r=null,i=null,m=null,d=250,w=()=>`
        <div class="bg-theme-${I.isDarkMode("dark","light")} shadow p-3 mx-0 mt-0 mb-3 rounded-4">
            <div class="d-flex flex-wrap justify-content-between align-items-center placeholder-wave">
                <span class="placeholder bg-secondary col-5 rounded-3 my-1"></span>
                <span class="placeholder bg-secondary col-3 rounded-3 my-1"></span>
            </div>
            <hr class="text-${I.isDarkMode("light","dark")} my-1">
            <p class="placeholder-wave m-0">
                <span class="placeholder bg-secondary col-6 rounded-3"></span>
                <span class="placeholder bg-secondary col-5 rounded-3"></span>
                <span class="placeholder bg-secondary col-12 rounded-3 my-1"></span>
            </p>
        </div>`,c=e=>{let n=I.isDarkMode("light","dark");return[["*",`<strong class="text-${n}">$1</strong>`],["_",`<em class="text-${n}">$1</em>`],["~",`<del class="text-${n}">$1</del>`],["```",`<code class="font-monospace text-${n}">$1</code>`]].forEach(x=>{let L=x[0],q=x[1];e=e.replace(new RegExp(`\\${L}(?=\\S)(.*?)(?<!\\s)\\${L}`,"gs"),q)}),e},y=e=>`
        <button style="font-size: 0.8rem;" onclick="undangan.comment.like.like(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-${I.isDarkMode("light","dark")} ms-auto rounded-3 p-0 shadow-sm d-flex justify-content-start align-items-center" data-offline-disabled="false">
            <span class="my-0 mx-1" data-count-like="${e.like.love}">${e.like.love}</span>
            <i class="me-1 ${g.has(e.uuid)?"fa-solid fa-heart text-danger":"fa-regular fa-heart"}"></i>
        </button>`,l=e=>{let n=I.isDarkMode("light","dark"),p=`<div class="d-flex flex-wrap justify-content-start align-items-center" data-button-action="${e.uuid}">`;return(r.get("can_reply")==!0||r.get("can_reply")===void 0)&&(p+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.reply(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-${n} rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Reply</button>`),o.has(e.uuid)&&(r.get("can_edit")==!0||r.get("can_edit")===void 0)&&(p+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.edit(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-${n} rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Edit</button>`),M.isAdmin()?p+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-${n} rounded-4 py-0 me-1 shadow-sm" data-own="${e.own}" data-offline-disabled="false">Delete</button>`:o.has(e.uuid)&&(r.get("can_delete")==!0||r.get("can_delete")===void 0)&&(p+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-${n} rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Delete</button>`),p+="</div>",p},f=(e,n)=>{let p=m.get("show").includes(e);return`<a class="text-${I.isDarkMode("light","dark")}" style="font-size: 0.8rem;" onclick="undangan.comment.showOrHide(this)" data-uuid="${e}" data-uuids="${n.join(",")}" data-show="${p?"true":"false"}" role="button" class="me-auto ms-1 py-0">${p?"Hide replies":`Show replies (${n.length})`}</a>`},s=e=>`
        <div class="d-flex flex-wrap justify-content-between align-items-center" id="button-${e.uuid}">
            ${l(e)}
            ${e.comments.length>0?f(e.uuid,e.comments.map(n=>n.uuid)):""}
            ${y(e)}
        </div>`,b=e=>{if(e.ip===void 0||e.user_agent===void 0||e.is_admin)return"";let n=I.isDarkMode("light","dark");return`
        <div class="mb-1 mt-3">
            <p class="text-${n} mb-1 mx-0 mt-0 p-0" style="font-size: 0.7rem;" id="ip-${e.uuid}"><i class="fa-solid fa-location-dot me-1"></i>${E.escapeHtml(e.ip)} ${i.has(e.ip)?`<strong>${i.get(e.ip)}</strong>`:'<span class="mb-1 placeholder col-2 rounded-3"></span>'}</p>
            <p class="text-${n} m-0 p-0" style="font-size: 0.7rem;"><i class="fa-solid fa-mobile-screen-button me-1"></i>${E.parseUserAgent(E.escapeHtml(e.user_agent))}</p>
        </div>`},k=(e,n)=>{let p=I.isDarkMode("dark","light");return n?`class="bg-theme-${p} shadow p-3 mx-0 mt-0 mb-3 rounded-4" data-parent="true"`:`class="${m.get("hidden").find(x=>x.uuid===e.uuid).show?"":"d-none"} overflow-x-scroll mw-100 border-start bg-theme-${p} py-2 ps-2 pe-0 my-2 ms-2 me-0"`},v=(e,n)=>e.is_admin?`<strong class="me-1">${E.escapeHtml(a.get("name")??r.get("name"))}</strong><i class="fa-solid fa-certificate text-primary"></i>`:n?`<strong class="me-1">${E.escapeHtml(e.name)}</strong><i id="badge-${e.uuid}" class="fa-solid ${e.presence?"fa-circle-check text-success":"fa-circle-xmark text-danger"}"></i>`:`<strong>${E.escapeHtml(e.name)}</strong>`,$=(e,n)=>{let p=I.isDarkMode("light","dark"),x=c(E.escapeHtml(e.comment)),L=x.length>d;return`
        <div class="d-flex flex-wrap justify-content-between align-items-center">
            <p class="text-${p} text-truncate m-0 p-0" style="font-size: 0.95rem;">${v(e,n)}</p>
            <small class="text-${p} m-0 p-0" style="font-size: 0.75rem;">${e.created_at}</small>
        </div>
        <hr class="text-${p} my-1">
        <p class="text-${p} my-1 mx-0 p-0" style="white-space: pre-wrap !important; font-size: 0.95rem;" ${L?`data-comment="${E.base64Encode(x)}"`:""} id="content-${e.uuid}">${L?x.slice(0,d)+"...":x}</p>
        ${L?`<p class="mb-2 mt-0 mx-0 p-0"><a class="text-${p}" role="button" style="font-size: 0.85rem; display: block;" data-show="false" onclick="undangan.comment.showMore(this, '${e.uuid}')">Selengkapnya</a></p>`:""}`},A=(e,n)=>`
        <div ${k(e,n)} id="${e.uuid}" style="overflow-wrap: break-word !important;">
            <div id="body-content-${e.uuid}" data-tapTime="0" data-liked="false" tabindex="0">
            ${$(e,n)}
            </div>
            ${b(e)}
            ${s(e)}
            <div id="reply-content-${e.uuid}">${e.comments.map(p=>O(p)).join("")}</div>
        </div>`,O=e=>A(e,!1);return{init:()=>{a=T("user"),o=T("owns"),g=T("likes"),r=T("config"),i=T("tracker"),m=T("comment")},renderEdit:(e,n)=>{let p=document.createElement("div");return p.classList.add("my-2"),p.id=`inner-${e}`,p.innerHTML=`
        <label for="form-inner-${e}" class="form-label my-1" style="font-size: 0.95rem;"><i class="fa-solid fa-pen me-2"></i>Edit</label>
        ${document.getElementById(e).getAttribute("data-parent")==="true"&&!M.isAdmin()?`
        <select class="form-select shadow-sm mb-2 rounded-4" id="form-inner-presence-${e}" data-offline-disabled="false">
            <option value="1" ${n?"selected":""}>Datang</option>
            <option value="2" ${n?"":"selected"}>Berhalangan</option>
        </select>`:""}
        <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type update comment" rows="3" data-offline-disabled="false"></textarea>
        <div class="d-flex flex-wrap justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${e}')" class="btn btn-sm btn-outline-${I.isDarkMode("light","dark")} rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.update(this)" data-uuid="${e}" class="btn btn-sm btn-outline-${I.isDarkMode("light","dark")} rounded-4 py-0" data-offline-disabled="false">Update</button>
        </div>`,p},renderReply:e=>{let n=document.createElement("div");return n.classList.add("my-2"),n.id=`inner-${e}`,n.innerHTML=`
        <label for="form-inner-${e}" class="form-label my-1" style="font-size: 0.95rem;"><i class="fa-solid fa-reply me-2"></i>Reply</label>
        <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type reply comment" rows="3" data-offline-disabled="false"></textarea>
        <div class="d-flex flex-wrap justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${e}')" class="btn btn-sm btn-outline-${I.isDarkMode("light","dark")} rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.send(this)" data-uuid="${e}" class="btn btn-sm btn-outline-${I.isDarkMode("light","dark")} rounded-4 py-0" data-offline-disabled="false">Send</button>
        </div>`,n},renderLoading:w,renderReadMore:f,renderInnerContent:O,renderContent:e=>A(e,!0),convertMarkdownToHTML:c,maxCommentLength:d}})();var z=window.confetti,Q=()=>z.shapeFromPath({path:"M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z",matrix:[.03333333333333333,0,0,.03333333333333333,-5.566666666666666,-5.533333333333333]}),Z=(a=15)=>{let o=a*1e3,g=Date.now()+o,r=Q(),i=["#FFC0CB","#FF1493","#C71585"],m=(d,w)=>Math.random()*(w-d)+d;(function d(){let w=g-Date.now();i.forEach(c=>{z({particleCount:1,startVelocity:0,ticks:Math.max(50,75*(w/o)),origin:{x:Math.random(),y:Math.abs(Math.random()-w/o)},zIndex:1057,colors:[c],shapes:[r],drift:m(-.5,.5),gravity:m(.5,1),scalar:m(.5,1)})}),w>0&&requestAnimationFrame(d)})()},ee=a=>{let o=Date.now()+25,g=Math.max(.3,Math.min(1,a.getBoundingClientRect().top/window.innerHeight+.2)),r=Q(),i=["#FF69B4","#FF1493"];(function m(){i.forEach(d=>{z({particleCount:2,angle:60,spread:55,shapes:[r],origin:{x:0,y:g},zIndex:1057,colors:[d]}),z({particleCount:2,angle:120,spread:55,shapes:[r],origin:{x:1,y:g},zIndex:1057,colors:[d]})}),Date.now()<o&&requestAnimationFrame(m)})()};var V=(()=>{let a=null,o=async i=>{let m=i.firstElementChild,d=i.lastElementChild,w=i.getAttribute("data-uuid"),c=parseInt(m.getAttribute("data-count-like"));i.disabled=!0,a.has(w)?await P(K,"/api/comment/"+a.get(w)).token(M.getToken()).send(B.statusResponse).then(y=>{y.data.status&&(a.unset(w),d.classList.remove("fa-solid","text-danger"),d.classList.add("fa-regular"),m.setAttribute("data-count-like",String(c-1)))}):await P(j,"/api/comment/"+w).token(M.getToken()).send(B.uuidResponse).then(y=>{y.code==201&&(a.set(w,y.data.uuid),d.classList.remove("fa-regular"),d.classList.add("fa-solid","text-danger"),m.setAttribute("data-count-like",String(c+1)))}),m.innerText=m.getAttribute("data-count-like"),i.disabled=!1};return{init:()=>{a=T("likes")},like:o,tapTap:async i=>{if(!navigator.onLine)return;let m=Date.now(),d=m-parseInt(i.getAttribute("data-tapTime")),w=i.id.replace("body-content-",""),c=d<300&&d>0,y=!a.has(w)&&i.getAttribute("data-liked")!=="true";if(c&&y){navigator.vibrate&&navigator.vibrate(100),z&&ee(i);let l=document.querySelector(`[onclick="undangan.comment.like.like(this)"][data-uuid="${w}"]`);i.setAttribute("data-liked","true"),await o(l),i.setAttribute("data-liked","false")}i.setAttribute("data-tapTime",m)}}})();var _=(()=>{let a=10,o=0,g=0,r=null,i=null,m=null,d=null,w=e=>{a=Number(e)},c=()=>a,y=()=>o,l=()=>g,f=()=>i.classList.contains("disabled")?null:i.classList.add("disabled"),s=()=>i.classList.contains("disabled")?i.classList.remove("disabled"):null,b=()=>m.classList.contains("disabled")?null:m.classList.add("disabled"),k=()=>m.classList.contains("disabled")?m.classList.remove("disabled"):null,v=()=>{d.classList.contains("d-none")&&d.classList.remove("d-none")},$=e=>{e.disabled=!0;let n=e.innerHTML;e.innerHTML='<span class="spinner-border spinner-border-sm my-0 mx-1 p-0" style="height: 0.8rem; width: 0.8rem;"></span>';let p=async()=>{await N.comment(),e.disabled=!1,e.innerHTML=n,N.scroll()};return{next:async()=>{o+=a,e.innerHTML="Next"+e.innerHTML,await p(),r.innerText=String(parseInt(r.innerText)+1)},prev:async()=>{o-=a,e.innerHTML=e.innerHTML+"Prev",await p(),r.innerText=String(parseInt(r.innerText)-1)}}};return{init:()=>{d=document.getElementById("pagination"),d.innerHTML=`
        <ul class="pagination mb-2 shadow-sm rounded-4">
            <li class="page-item disabled" id="previous">
                <button class="page-link rounded-start-4" onclick="undangan.comment.pagination.previous(this)" data-offline-disabled="false">
                    <i class="fa-solid fa-circle-left me-1"></i>Prev
                </button>
            </li>
            <li class="page-item disabled">
                <span class="page-link text-light" id="page">1</span>
            </li>
            <li class="page-item" id="next">
                <button class="page-link rounded-end-4" onclick="undangan.comment.pagination.next(this)" data-offline-disabled="false">
                    Next<i class="fa-solid fa-circle-right ms-1"></i>
                </button>
            </li>
        </ul>`,r=document.getElementById("page"),i=document.getElementById("previous"),m=document.getElementById("next")},setPer:w,getPer:c,getNext:y,reset:async()=>o===0?!1:(o=0,g=0,r.innerText=1,b(),f(),await N.comment(),!0),setResultData:e=>{if(g=e,o>0&&s(),g<a){b();return}k(),v()},getResultData:l,previous:async e=>{f(),!(o<0)&&(b(),await $(e).prev())},next:async e=>{b(),!(g<a)&&(f(),await $(e).next())}}})();var N=(()=>{let a=null,o=null,g=null,r=null,i=()=>`<div class="text-center p-4 my-2 bg-theme-${I.isDarkMode("dark","light")} rounded-4 shadow"><p class="fw-bold p-0 m-0" style="font-size: 0.95rem;">Yuk bagikan undangan ini biar banyak komentarnya</p></div>`,m=(u,t)=>{document.querySelector(`[data-button-action="${u}"]`).childNodes.forEach(h=>{h.disabled=t})},d=async u=>{if(!confirm("Are you sure?"))return;let t=u.getAttribute("data-uuid");M.isAdmin()&&a.set(t,u.getAttribute("data-own")),m(t,!0);let h=E.disableButton(u),e=document.querySelector(`[onclick="undangan.comment.like.like(this)"][data-uuid="${t}"]`);if(e.disabled=!0,!await P(X,"/api/comment/"+a.get(t)).token(M.getToken()).send(B.statusResponse).then(x=>x.data.status,()=>!1)){h.restore(),e.disabled=!1;return}document.querySelectorAll('a[onclick="undangan.comment.showOrHide(this)"]').forEach(x=>{let L=x.getAttribute("data-uuids").split(",");if(L.find(q=>q===t)){let q=L.filter(C=>C!==t).join(",");q.length===0?x.remove():x.setAttribute("data-uuids",q)}}),a.unset(t),document.getElementById(t).remove();let p=document.getElementById("comments");p.children.length==0&&(p.innerHTML=i())},w=async u=>{let t=u.getAttribute("data-uuid"),h=!1,e=document.getElementById(`form-inner-presence-${t}`);e&&(e.disabled=!0,h=e.value==="1");let n=document.getElementById(`form-${t?`inner-${t}`:"comment"}`),p=!1,x=document.getElementById(`badge-${t}`);if(x&&(p=x.classList.contains("text-success")),t&&E.base64Encode(n.value)===n.getAttribute("data-original")&&p===h){m(t,!1),document.getElementById(`inner-${t}`).remove();return}n.disabled=!0;let L=document.querySelector(`[onclick="undangan.comment.cancel('${t}')"]`);L&&(L.disabled=!0);let q=E.disableButton(u),C=await P(W,"/api/comment/"+a.get(t)).token(M.getToken()).body(B.updateCommentRequest(e?h:null,n.value)).send(B.statusResponse).then(se=>se.data.status,()=>!1);if(n.disabled=!1,L&&(L.disabled=!1),e&&(e.disabled=!1),q.restore(),!C)return;m(t,!1),document.getElementById(`inner-${t}`).remove();let D=document.querySelector(`[onclick="undangan.comment.showMore(this, '${t}')"]`),H=R.convertMarkdownToHTML(E.escapeHtml(n.value)),F=document.getElementById(`content-${t}`);if(H.length>R.maxCommentLength?(F.innerHTML=D?.getAttribute("data-show")==="false"?H.slice(0,R.maxCommentLength)+"...":H,F.setAttribute("data-comment",E.base64Encode(H)),D?.style.display==="none"&&(D.style.display="block")):(F.innerHTML=H,F.removeAttribute("data-comment"),D?.style.display==="block"&&(D.style.display="none")),e&&(document.getElementById("form-presence").value=h?"1":"2",T("information").set("presence",h)),!(!e||!x)){if(h){x.classList.remove("fa-circle-xmark","text-danger"),x.classList.add("fa-circle-check","text-success");return}x.classList.remove("fa-circle-check","text-success"),x.classList.add("fa-circle-xmark","text-danger")}},c=async u=>{let t=u.getAttribute("data-uuid"),h=document.getElementById("form-name"),e=h.value;if(M.isAdmin()&&(e=o.get("name")),e.length==0){t&&h.scrollIntoView({behavior:"smooth"}),alert("Silakan masukkan nama Anda.");return}let n=document.getElementById("form-presence");if(!t&&n&&n.value=="0"){alert("Silakan pilih status kehadiran Anda.");return}!t&&h&&!M.isAdmin()&&(h.disabled=!0),n&&n.value!="0"&&(n.disabled=!0);let p=document.getElementById(`form-${t?`inner-${t}`:"comment"}`);p.disabled=!0;let x=document.querySelector(`[onclick="undangan.comment.cancel('${t}')"]`);x&&(x.disabled=!0);let L=E.disableButton(u),q=n?n.value==="1":!0;if(!M.isAdmin()){let D=T("information");D.set("name",e),t||D.set("presence",q)}let C=await P(j,"/api/comment").token(M.getToken()).body(B.postCommentRequest(t,e,q,p.value)).send(B.getCommentResponse).then(D=>D,()=>null);if(h&&(h.disabled=!1),p.disabled=!1,x&&(x.disabled=!1),n&&(n.disabled=!1),L.restore(),!(!C||C.code!==201)){if(a.set(C.data.uuid,C.data.own),p.value=null,!t){if(await _.reset()){A();return}C.data.is_admin=M.isAdmin();let H=document.getElementById("comments");_.setResultData(H.children.length),_.getResultData()==_.getPer()&&H.lastElementChild.remove(),H.innerHTML=R.renderContent(C.data)+H.innerHTML,A()}if(t){r.set("hidden",r.get("hidden").concat([B.commentShowMore(C.data.uuid,!0)])),r.set("show",r.get("show").concat([t])),m(t,!1),document.getElementById(`inner-${t}`).remove(),C.data.is_admin=M.isAdmin(),document.getElementById(`reply-content-${t}`).insertAdjacentHTML("beforeend",R.renderInnerContent(C.data));let D=document.getElementById(`button-${t}`),H=D.querySelector("a"),F=[C.data.uuid];H&&(H.getAttribute("data-show")==="false"&&b(H),H.remove()),D.querySelector(`button[onclick="undangan.comment.like.like(this)"][data-uuid="${t}"]`).insertAdjacentHTML("beforebegin",R.renderReadMore(t,H?H.getAttribute("data-uuids").split(",").concat(F):F))}v(C.data)}},y=u=>{let t=document.getElementById(`form-inner-${u}`),h=!1,e=document.getElementById(`form-inner-presence-${u}`);e&&(h=e.value==="1");let n=!1,p=document.getElementById(`badge-${u}`);p&&(n=p.classList.contains("text-success")),(t.value.length===0||E.base64Encode(t.value)===t.getAttribute("data-original")&&n===h||confirm("Are you sure?"))&&(m(u,!1),document.getElementById(`inner-${u}`).remove())},l=u=>{let t=u.getAttribute("data-uuid");document.getElementById(`inner-${t}`)||(m(t,!0),document.getElementById(`button-${t}`).insertAdjacentElement("afterend",R.renderReply(t)))},f=async u=>{let t=u.getAttribute("data-uuid");if(document.getElementById(`inner-${t}`))return;m(t,!0);let h=E.disableButton(u);await P(U,"/api/comment/"+t).token(M.getToken()).send(B.commentResponse).then(e=>{if(e.code!==200)return;document.getElementById(`button-${t}`).insertAdjacentElement("afterend",R.renderEdit(t,e.data.presence));let n=document.getElementById(`form-inner-${t}`);n.value=e.data.comment,n.setAttribute("data-original",E.base64Encode(e.data.comment))}),h.restore(),u.disabled=!0},s=()=>{let u=document.getElementById("comments");return u.getAttribute("data-loading")==="false"&&(u.setAttribute("data-loading","true"),u.innerHTML=R.renderLoading().repeat(_.getPer())),P(U,`/api/comment?per=${_.getPer()}&next=${_.getNext()}`).token(M.getToken()).send(B.getCommentsResponse).then(t=>{if(_.setResultData(t.data.length),u.setAttribute("data-loading","false"),t.data.length===0)return u.innerHTML=i(),t;let h=(e,n)=>(e.forEach(p=>{n.find(x=>x.uuid===p.uuid)||n.push(B.commentShowMore(p.uuid)),p.comments&&p.comments.length>0&&h(p.comments,n)}),n);return r.set("hidden",h(t.data,r.get("hidden"))),u.innerHTML=t.data.map(e=>R.renderContent(e)).join(""),t.data.forEach($),t.data.forEach(v),t})},b=u=>{let t=u.getAttribute("data-uuids").split(","),h=u.getAttribute("data-show")==="true",e=u.getAttribute("data-uuid");h?(u.setAttribute("data-show","false"),u.innerText="Show replies",u.innerText+=" ("+t.length+")",r.set("show",r.get("show").filter(n=>n!==e))):(u.setAttribute("data-show","true"),u.innerText="Hide replies",r.set("show",r.get("show").concat([e])));for(let n of t){r.set("hidden",r.get("hidden").map(x=>(x.uuid===n&&(x.show=!h),x)));let p=document.getElementById(n).classList;h?p.add("d-none"):p.remove("d-none")}},k=(u,t)=>{let h=document.getElementById(`content-${t}`),e=E.base64Decode(h.getAttribute("data-comment")),n=u.getAttribute("data-show")==="false";h.innerHTML=n?e:e.slice(0,R.maxCommentLength)+"...",u.innerText=n?"Sebagian":"Selengkapnya",u.setAttribute("data-show",n?"true":"false")},v=u=>{u.comments&&u.comments.forEach(v);let t=document.getElementById(`body-content-${u.uuid}`);t.addEventListener("touchend",()=>V.tapTap(t))},$=u=>{M.isAdmin()&&(u.comments&&u.comments.forEach($),!(u.ip===void 0||u.user_agent===void 0||u.is_admin||g.has(u.ip))&&fetch(`https://freeipapi.com/api/json/${u.ip}`).then(t=>t.json()).then(t=>{let h=t.cityName+" - "+t.regionName;t.cityName=="-"&&t.regionName=="-"&&(h="localhost"),g.set(u.ip,h),document.getElementById(`ip-${u.uuid}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${E.escapeHtml(u.ip)} <strong>${h}</strong>`}).catch(t=>{document.getElementById(`ip-${u.uuid}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${E.escapeHtml(u.ip)} <strong>${E.escapeHtml(t.message)}</strong>`}))},A=()=>document.getElementById("comments").scrollIntoView({behavior:"smooth"});return{like:V,pagination:_,init:()=>{V.init(),R.init(),_.init(),a=T("owns"),o=T("user"),g=T("tracker"),r=T("comment"),r.has("hidden")||r.set("hidden",[]),r.has("show")||r.set("show",[])},scroll:A,cancel:y,send:c,edit:f,reply:l,remove:d,update:w,comment:s,showMore:k,showOrHide:b}})();var te=window.bootstrap;var ne=(()=>{let a=null,o=()=>{let l=document.getElementById("count-down")?.getAttribute("data-time")?.replace(" ","T");if(!l)return;let f=new Date(l).getTime();setInterval(()=>{let s=Math.abs(f-Date.now());document.getElementById("day").innerText=Math.floor(s/(1e3*60*60*24)),document.getElementById("hour").innerText=Math.floor(s%(1e3*60*60*24)/(1e3*60*60)),document.getElementById("minute").innerText=Math.floor(s%(1e3*60*60)/(1e3*60)),document.getElementById("second").innerText=Math.floor(s%(1e3*60)/1e3)},1e3)},g=(l,f=.01)=>{let s=document.getElementById(l),b=parseFloat(s.style.opacity),k=null;k=setInterval(()=>{if(b>0){s.style.opacity=b.toFixed(3),b-=f;return}clearInterval(k),k=null,s.remove()},10)},r=()=>{let l=window.location.search.split("to="),f=null;if(l.length>1&&l[1].length>0&&(f=window.decodeURIComponent(l[1])),f){let b=document.getElementById("guest-name"),k=document.createElement("div");k.classList.add("m-2"),k.innerHTML=`
                <p class="mt-0 mb-1 mx-0 p-0" style="font-size: 0.95rem;">${b?.getAttribute("data-message")}</p>
                <h2 class="m-0 p-0">${E.escapeHtml(f)}</h2>
            `,b?.appendChild(k)}let s=document.getElementById("form-name");s&&(s.value=a.get("name")??f),g("loading",.025)},i=l=>{l.disabled=!0,I.isAutoMode()||(document.getElementById("button-theme").style.display="none"),z({origin:{y:1},zIndex:1057}),g("welcome",.025),J.init(),I.spyTop(),E.timeOut(Z,1500)},m=l=>{document.getElementById("show-modal-image").src=l.src,te.Modal.getOrCreateInstance("#modal-image").show()},d=()=>a.set("info",!0),w=()=>{document.querySelectorAll(".font-arabic").forEach(l=>{l.innerHTML=String(l.innerHTML).normalize("NFC")})},c=()=>{document.querySelectorAll("svg").forEach(l=>{E.timeOut(()=>l.classList.add(l.getAttribute("data-class")),parseInt(l.getAttribute("data-time")))})};return{init:()=>{I.init(),M.init(),Y.init(),S.init(),a=T("information"),document.addEventListener("progressDone",()=>{document.body.scrollIntoView({behavior:"instant"}),w(),window.AOS.init(),o(),r(),c()}),M.isAdmin()&&(T("user").clear(),T("owns").clear(),T("likes").clear(),T("session").clear(),T("comment").clear(),T("tracker").clear()),a.has("presence")&&(document.getElementById("form-presence").value=a.get("presence")?"1":"2");let l=document.getElementById("information");l&&a.get("info")&&l.remove();let f=document.body.getAttribute("data-key");if((!f||f.length===0)&&(G.init().load(),document.getElementById("comment")?.remove(),document.querySelector('a.nav-link[href="#comment"]')?.closest("li.nav-item")?.remove()),f.length>0){S.add(),S.add();let s=G.init();s.hasDataSrc()||s.load(),window.addEventListener("load",()=>{let b=new URLSearchParams(window.location.search);M.setToken(b.get("k")??f),M.guest().then(k=>{if(k.code!==200){S.invalid("config");return}S.complete("config"),s.hasDataSrc()&&s.load(),N.init(),N.comment().then(()=>S.complete("comment")).catch(()=>S.invalid("comment"))}).catch(()=>S.invalid("config"))})}return{util:E,theme:I,comment:N,guest:{open:i,modal:m,closeInformation:d}}}}})();document.addEventListener("DOMContentLoaded",()=>{window.undangan=ne.init()});})();
